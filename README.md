# 🏛️ FSS 규제 인텔리전스 플랫폼

> 금융위원회 의결서를 AI가 자동으로 읽고 분석하여, 누구나 쉽게 금융 규제 정보를 검색할 수 있는 시스템

## 📌 한 줄 요약
**"금융위원회 의결서 PDF를 AI가 자동으로 분석하여 데이터베이스화하고, 자연어로 검색할 수 있게 만든 웹 서비스"**

## 🎯 이 시스템이 해결하는 문제

### 기존 방식의 불편함
- 📄 수천 개의 PDF 파일을 일일이 열어봐야 함
- 🔍 특정 제재 사례를 찾기 위해 문서를 하나씩 검색
- 📊 통계나 트렌드 분석이 거의 불가능

### 우리의 해결책
- 🤖 AI가 모든 PDF를 자동으로 읽고 분석
- 💬 "작년에 과태료 받은 보험사는?" 같은 자연어로 검색
- 📈 실시간 통계와 트렌드를 한눈에 확인

## 🏗️ 시스템 구조도

```
┌─────────────────────────────────────────────────────────────────┐
│                        사용자 인터페이스                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐    │
│  │   검색창    │  │  대시보드   │  │   상세 결과 보기    │    │
│  │ "과태료"   │  │  통계/차트  │  │   법률 정보 포함    │    │
│  └─────────────┘  └─────────────┘  └─────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                          API 서버                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │             자연어 → SQL 변환 엔진 (AI)                  │   │
│  │  "최근 3년간 과태료" → SELECT * FROM actions WHERE...   │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                         데이터베이스                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────┐     │
│  │   의결서     │  │    조치      │  │      법률        │     │
│  │ (Decisions)  │◄─┤  (Actions)   │──►│     (Laws)       │     │
│  └──────────────┘  └──────────────┘  └──────────────────┘     │
└─────────────────────────────────────────────────────────────────┘
                                ▲
                                │
┌─────────────────────────────────────────────────────────────────┐
│                    데이터 처리 파이프라인                        │
│                                                                 │
│  금융위 홈페이지 → PDF 다운로드 → AI 분석 → DB 저장           │
│       (크롤러)        (2,000개+)    (Gemini)   (자동화)        │
└─────────────────────────────────────────────────────────────────┘
```

## 🚀 주요 기능

- **FSC 의결서 자동 수집**: 금융위원회 홈페이지에서 의결서 자동 다운로드
- **하이브리드 PDF 처리**: Rule-based 패턴 매칭 + AI 보완으로 최적화된 구조화
  - Rule-based: 한국어 의결서 표준 패턴 추출 (95%+ 정확도)
  - AI 보완: 복잡한 위반 내용 요약 및 카테고리 분류
- **복합키 데이터베이스**: 연도별 의결번호 중복을 처리하는 고도화된 스키마
- **법률 정보 매핑**: Action-Law 다대다 관계를 통한 정교한 법적 근거 추적
- **자연어 쿼리**: 한국어 자연어를 SQL로 변환하여 복합적인 분석 가능
- **웹 인터페이스**: FastAPI 기반 REST API 및 검색 기능

## 📅 개발 진행 현황

### ✅ V2 시스템 주요 성과 (2025년 7월 20일 기준)

#### 🎉 핵심 성과
- **68개 의결서** 성공적으로 처리 완료 (2025년 전체 83개 중 81.9%)
- **Gemini Structured Output** 도입으로 데이터 추출 정확도 향상
- **완전한 웹 서비스** 구현 (프론트엔드 + 백엔드 + AI 검색)

#### 🔧 기술적 혁신
- **V2 아키텍처**: Pydantic 기반 구조화된 AI 출력으로 안정성 확보
- **하이브리드 처리**: Rule-based (95% 정확도) + AI 보완
- **실시간 검색**: 자연어 → SQL 변환 (Gemini 2.5 Flash)
- **법률 매핑**: M:N 관계로 복잡한 법적 근거 완벽 추적

### 📊 처리 현황 상세

| 항목 | 수치 | 설명 |
|------|------|------|
| 전체 의결서 | 83개 | 2025년 전체 |
| V2 처리 완료 | **68개** | 81.9% 완료 |
| 건너뛴 파일 | 15개 | 증권사 관련 복잡한 파일 |
| 추출된 조치 | 70개+ | 과태료, 과징금 등 |
| 법률 매핑 | 40개+ | 자동 정규화 및 연결 |

### 🌟 최신 업데이트 (V2 시스템)

#### 데이터 처리 개선
- ✅ **Gemini Structured Output**: JSON 스키마 기반 안정적 추출
- ✅ **Surrogate Key 도입**: 데이터 무결성 향상
- ✅ **법률 정보 완벽 표시**: 검색 결과에 관련 법률 포함

#### 사용자 경험 개선  
- ✅ **실시간 검색**: 자연어 입력 즉시 결과 표시
- ✅ **상세 정보 보기**: 의결서별 모든 조치와 법률 확인
- ✅ **PDF 다운로드**: 원본 문서 즉시 다운로드
- ✅ **통계 대시보드**: 제재 유형별, 업권별 현황

### 🚧 다음 단계
- [ ] **2021-2024년 데이터 처리**: 과거 4년치 의결서 일괄 처리
- [ ] **고급 분석 기능**: 시계열 트렌드, 업권별 비교 분석
- [ ] **API 공개**: 외부 개발자를 위한 Open API
- [ ] **모바일 앱**: iOS/Android 네이티브 앱 개발

## 📋 시스템 요구사항

- Python 3.11+
- PostgreSQL 15+ (개발 단계에서는 SQLite 사용)
- Google Gemini API 키

## 🛠️ 설치 및 설정

### 1. 저장소 클론
```bash
git clone <repository-url>
cd fss_db
```

### 2. 가상환경 설정
```bash
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### 3. 의존성 설치
```bash
pip install -r requirements-core.txt
```

### 4. 환경 변수 설정
```bash
cp .env.example .env
# .env 파일을 편집하여 Google Gemini API 키 설정
```

### 5. 데이터베이스 초기화
```bash
python -c "from app.core.database import init_db; init_db()"
```

## 💻 사용 방법 (개발자용)

### 1. 백엔드 서버 실행
```bash
source venv/bin/activate
uvicorn app.main:app --reload --port 8000
```

### 2. 프론트엔드 실행
```bash
cd frontend
npm install  # 첫 실행시만
npm run dev
```

웹 브라우저에서 http://localhost:3000 접속

### 2. FSC 의결서 크롤링
```bash
source venv/bin/activate
python scripts/crawler.py --start-date 2024-01-01 --end-date 2024-12-31
```

### 3. PDF 파일 처리 (배치)
```bash
source venv/bin/activate
python process_2025_batch.py  # 2025년 의결서 전체 처리
```

### 4. 단일 PDF 파일 처리
```bash
source venv/bin/activate
python scripts/process_pdfs.py --single-file /path/to/decision.pdf
```

### 5. 처리 통계 확인
```bash
source venv/bin/activate
python -c "
from app.core.database import SessionLocal
from app.models.fsc_models import Decision, Action, Law
db = SessionLocal()
print(f'의결서: {db.query(Decision).count()}개')
print(f'조치: {db.query(Action).count()}개')  
print(f'법률: {db.query(Law).count()}개')
db.close()
"
```

## 📊 API 엔드포인트

### 의결서 관련
- `GET /api/v1/decisions/` - 의결서 목록 조회
- `GET /api/v1/decisions/{id}` - 특정 의결서 상세 조회
- `GET /api/v1/decisions/{id}/actions` - 의결서 관련 조치 목록
- `GET /api/v1/decisions/stats/categories` - 카테고리별 통계

### 검색 관련
- `POST /api/v1/search/nl2sql` - 자연어 쿼리 검색
- `POST /api/v1/search/text` - 전문 텍스트 검색
- `GET /api/v1/search/suggestions` - 검색 제안

## 🔍 사용 예시 (실제 검색 가능한 질문들)

### 💬 자연어로 이렇게 검색하세요!

#### 제재 관련
- "**과태료** 받은 보험사 목록"
- "**1억원 이상** 과징금 사례"
- "**직무정지** 처분 받은 회계사"

#### 기간별 검색
- "**2025년** 모든 제재 내역"
- "**최근 3개월** 금융기관 처분"
- "**올해** 가장 큰 과징금은?"

#### 업권별 분석
- "**증권사** 관련 모든 조치"
- "**은행**의 내부통제 위반 사례"
- "**보험사** 불완전판매 제재"

### 🎨 검색 결과 화면
```
┌─────────────────────────────────────────────────────┐
│ 🔍 "과태료"                                  [검색] │
├─────────────────────────────────────────────────────┤
│                                                     │
│ 📊 검색 결과: 24건                                  │
│                                                     │
│ ┌─────────────────────────────────────────────┐   │
│ │ 2025-115호 | KB손해보험㈜                   │   │
│ │ 과태료: 1,000만원                           │   │
│ │ 위반: 보험업법 제95조의2                    │   │
│ │ [상세보기] [PDF 다운로드]                   │   │
│ └─────────────────────────────────────────────┘   │
│                                                     │
│ ┌─────────────────────────────────────────────┐   │
│ │ 2025-60호 | 삼성화재해상보험㈜             │   │
│ │ 과태료: 1,200만원                           │   │
│ │ 위반: 금융소비자보호법 제16조               │   │
│ │ [상세보기] [PDF 다운로드]                   │   │
│ └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

## 🗄️ 데이터 구조 (비전문가를 위한 설명)

### 📋 의결서 (Decisions)
하나의 의결서는 하나의 회의록과 같습니다.
- **의결번호**: 2025년 제60호 (년도-번호로 구분)
- **제목**: 무엇에 대한 결정인지
- **분류**: 제재인지, 인허가인지, 정책결정인지

### ⚖️ 조치사항 (Actions)  
의결서 하나에 여러 조치가 포함될 수 있습니다.
- **대상**: 누가 처분을 받았는지 (기관명, 개인명)
- **조치유형**: 과태료, 과징금, 경고, 직무정지 등
- **금액**: 얼마의 벌금인지
- **위반내용**: 무엇을 잘못했는지

### 📚 법률정보 (Laws)
각 조치의 법적 근거가 되는 법률들입니다.
- **법률명**: 보험업법, 은행법 등
- **조항**: 제95조 제1항 (구체적 조항)
- **내용**: 해당 조항이 무엇을 규정하는지

### 🔗 관계도
```
의결서 1개 ─── 포함 ──→ 조치 N개
                         │
                         └── 근거법률 M개
```

## 🛠️ 기술 스택

### Backend
- **Python 3.11+**: 메인 언어
- **FastAPI**: REST API 프레임워크
- **SQLAlchemy**: ORM
- **Google Gemini API**: AI 처리

### Frontend  
- **Next.js 14**: React 프레임워크
- **TypeScript**: 타입 안정성
- **Ant Design**: UI 컴포넌트
- **TailwindCSS**: 스타일링

### Database
- **PostgreSQL**: 프로덕션 DB
- **SQLite**: 개발용 DB

### AI/ML
- **Gemini 2.5 Flash**: 자연어 처리
- **Structured Output**: JSON 스키마 검증
- **LangChain**: NL2SQL 변환

### 새로운 기능 추가
1. 모델 정의: `app/models/`
2. 서비스 로직: `app/services/`
3. API 엔드포인트: `app/api/v1/endpoints/`
4. 테스트 작성: `tests/`

## 🏃‍♂️ 빠른 시작 (Quick Start)

### 1️⃣ 필수 준비물
- Python 3.11 이상
- Node.js 18 이상  
- Google Gemini API 키 ([여기서 발급](https://makersuite.google.com/app/apikey))

### 2️⃣ 설치 (5분 소요)
```bash
# 1. 저장소 복제
git clone https://github.com/your-repo/fss_db.git
cd fss_db

# 2. Python 환경 설정
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements-core.txt

# 3. 환경 변수 설정
cp .env.example .env
# .env 파일에 GEMINI_API_KEY 입력

# 4. 데이터베이스 초기화
python -c "from app.core.database import init_db; init_db()"

# 5. 프론트엔드 설정
cd frontend
npm install
```

### 3️⃣ 실행
```bash
# 터미널 1: 백엔드
uvicorn app.main:app --reload

# 터미널 2: 프론트엔드
cd frontend && npm run dev
```

### 4️⃣ 사용
브라우저에서 http://localhost:3000 접속 → 검색창에 "과태료" 입력 → Enter!

## 🔐 보안 고려사항

- API 키는 환경 변수로 관리
- 사용자 입력 검증 및 SQL 인젝션 방지
- 파일 업로드 시 보안 검증
- 로그에 민감한 정보 기록 금지

## 📈 성능 최적화

- 데이터베이스 인덱스 최적화
- 쿼리 결과 캐싱
- 비동기 처리 활용
- 파일 처리 배치 최적화

## ❓ 자주 묻는 질문 (FAQ)

### Q: Gemini API 무료 한도는?
**A:** 하루 50회 (무료 티어). V2 시스템은 이를 고려해 배치 처리합니다.

### Q: 왜 일부 PDF는 처리하지 못하나요?
**A:** 증권사 관련 복잡한 문서(15개)는 현재 건너뜁니다. 추후 개선 예정.

### Q: 과거 년도 데이터도 처리 가능한가요?
**A:** 네, 2021-2024년 데이터도 동일한 방식으로 처리 가능합니다.

### Q: 검색이 느린 이유는?
**A:** 첫 검색시 AI가 SQL을 생성하므로 2-3초 걸립니다. 이후는 빠릅니다.


